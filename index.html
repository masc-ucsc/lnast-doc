


  

  

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>LNAST</title>

    <style>
    </style>
    <link rel="stylesheet" media="screen" href="pub/css/screen.css">
    <link rel="stylesheet" media="print" href="pub/css/print.css">
    <link rel="stylesheet" media="screen" href="pub/css/darkula.css">
    
      <script src="source/javascripts/lib/_jquery.js"></script>
<script src="source/javascripts/lib/_jquery.highlight.js"></script>
<script src="source/javascripts/lib/_lunr.js"></script>
<script src="source/javascripts/lib/_imagesloaded.min.js"></script>
<script src="source/javascripts/lib/_energize.js"></script>
<script src="source/javascripts/app/_lang.js"></script>
<script src="source/javascripts/app/_search.js"></script>
<script src="source/javascripts/app/_toc.js"></script>
<script type="text/javascript">
$(function() {
  loadToc($('#toc'), '.toc-link', '.toc-list-h2, .toc-list-h3, .toc-list-h4, .toc-list-h5, .toc-list-h6', 10);
  setupLanguages($('body').data('languages'));
  $('.content').imagesLoaded( function() {
    recacheHeights();
    refreshToc();
  });
});

window.onpopstate = function() {
  activateLanguage(getLanguageFromQueryString());
};
</script>

    
    <!-- shins; content for the head element from source/includes/_head.md -->
<meta name="theme-color" content="#F3F7F9">
<!-- Renderer: Shins v2.4.1-0 -->
  </head>

  <body data-languages="[&quot;coffescript&quot;,&quot;verilog&quot;,&quot;shell&quot;,&quot;cpp&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="source/images/navbar.png" class="undefined" alt="Navigation">
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="source/images/logo.png" class="logo" alt="Logo">
      
        <div class="lang-selector">
          
            
              <a href="#" data-language-name="coffescript">pyrope</a>
            
          
            
              <a href="#" data-language-name="verilog">verilog</a>
            
          
            
              <a href="#" data-language-name="shell">cfg</a>
            
          
            
              <a href="#" data-language-name="cpp">cpp</a>
            
          
        </div>
      
      
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      
      <div id="toc" class="toc-list-h1">
	  	<ul class="toc-list-h1">
        
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
            
              <ul class="toc-list-h2">
                
                  <li>
                    <a href="#function-overloadings-of-node-data-construction" class="toc-h2 toc-link" data-title="">Function Overloadings of Node Data Construction</a>
                    
                  </li>
                
                  <li>
                    <a href="#another-example" class="toc-h2 toc-link" data-title="">Another Example</a>
                    
                  </li>
                
              </ul>
            
          </li>
        
          <li>
            <a href="#module-input--output--and-register-declaration" class="toc-h1 toc-link" data-title="Module Input, Output, and Register Declaration">Module Input, Output, and Register Declaration</a>
            
              <ul class="toc-list-h2">
                
                  <li>
                    <a href="#input" class="toc-h2 toc-link" data-title="">Input</a>
                    
                  </li>
                
                  <li>
                    <a href="#output" class="toc-h2 toc-link" data-title="">Output</a>
                    
                  </li>
                
                  <li>
                    <a href="#register" class="toc-h2 toc-link" data-title="">Register</a>
                    
                  </li>
                
              </ul>
            
          </li>
        
          <li>
            <a href="#assign-statement" class="toc-h1 toc-link" data-title="Assign Statement">Assign Statement</a>
            
              <ul class="toc-list-h2">
                
                  <li>
                    <a href="#assign-trivial-constant" class="toc-h2 toc-link" data-title="">Assign Trivial Constant</a>
                    
                  </li>
                
                  <li>
                    <a href="#assign-simple-expression" class="toc-h2 toc-link" data-title="">Assign Simple Expression</a>
                    
                  </li>
                
              </ul>
            
          </li>
        
          <li>
            <a href="#unary-operation-statement" class="toc-h1 toc-link" data-title="Unary Operation Statement">Unary Operation Statement</a>
            
              <ul class="toc-list-h2">
                
                  <li>
                    <a href="#binary-not-operation" class="toc-h2 toc-link" data-title="">Binary Not Operation</a>
                    
                  </li>
                
                  <li>
                    <a href="#logical-not-operation" class="toc-h2 toc-link" data-title="">Logical Not Operation</a>
                    
                  </li>
                
              </ul>
            
          </li>
        
          <li>
            <a href="#n-ary-operation-statement" class="toc-h1 toc-link" data-title="N-ary Operation Statement">N-ary Operation Statement</a>
            
              <ul class="toc-list-h2">
                
                  <li>
                    <a href="#and-operation" class="toc-h2 toc-link" data-title="">And Operation</a>
                    
                  </li>
                
              </ul>
            
          </li>
        
          <li>
            <a href="#if-statement" class="toc-h1 toc-link" data-title="If Statement">If Statement</a>
            
              <ul class="toc-list-h2">
                
                  <li>
                    <a href="#simple-case" class="toc-h2 toc-link" data-title="">Simple Case</a>
                    
                  </li>
                
                  <li>
                    <a href="#full-case" class="toc-h2 toc-link" data-title="">Full Case</a>
                    
                  </li>
                
              </ul>
            
          </li>
        
          <li>
            <a href="#tuple-statement" class="toc-h1 toc-link" data-title="Tuple Statement">Tuple Statement</a>
            
              <ul class="toc-list-h2">
                
                  <li>
                    <a href="#tuple-concatenation-statement" class="toc-h2 toc-link" data-title="">Tuple Concatenation Statement</a>
                    
                  </li>
                
              </ul>
            
          </li>
        
          <li>
            <a href="#for-loop-statement" class="toc-h1 toc-link" data-title="For Loop Statement">For Loop Statement</a>
            
          </li>
        
          <li>
            <a href="#while-loop-statement" class="toc-h1 toc-link" data-title="While Loop Statement">While Loop Statement</a>
            
          </li>
        
          <li>
            <a href="#function-definition-statement" class="toc-h1 toc-link" data-title="Function Definition Statement">Function Definition Statement</a>
            
              <ul class="toc-list-h2">
                
                  <li>
                    <a href="#basic-function-definition" class="toc-h2 toc-link" data-title="">Basic Function Definition</a>
                    
                  </li>
                
                  <li>
                    <a href="#conditional-function-definition" class="toc-h2 toc-link" data-title="">Conditional Function Definition</a>
                    
                  </li>
                
              </ul>
            
          </li>
        
          <li>
            <a href="#function-call" class="toc-h1 toc-link" data-title="Function Call">Function Call</a>
            
              <ul class="toc-list-h2">
                
                  <li>
                    <a href="#implicit-function-argument-assignment" class="toc-h2 toc-link" data-title="">Implicit Function Argument Assignment</a>
                    
                  </li>
                
                  <li>
                    <a href="#explicit-function-argument-assignment" class="toc-h2 toc-link" data-title="">Explicit Function Argument Assignment</a>
                    
                  </li>
                
              </ul>
            
          </li>
        
          <li>
            <a href="#attribute-statement" class="toc-h1 toc-link" data-title="Attribute statement">Attribute statement</a>
            
          </li>
        
          <li>
            <a href="#string-management" class="toc-h1 toc-link" data-title="String management">String management</a>
            
          </li>
        
          <li>
            <a href="#examples" class="toc-h1 toc-link" data-title="Examples">Examples</a>
            
              <ul class="toc-list-h2">
                
                  <li>
                    <a href="#trivial-counter" class="toc-h2 toc-link" data-title="">trivial counter</a>
                    
                  </li>
                
              </ul>
            
          </li>
        
		</ul>
      </div>
      
        <ul class="toc-footer">
          
            <li><a href="https://github.com/masc-ucsc/livehd">LiveHD on Github</a></li>
          
        </ul>
      
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <!-- Renderer: Shins v2.4.1-0 --><h1 id="introduction">Introduction</h1>
<p>LNAST stands for Language-Neutral Abstract Syntax Tree, which is constituted of<br>
Lnast_nodes and indexed by a tree structure.</p>
<p>Each Lnast_node should has a specific node type and contain the following information from source code tokens<br>
(a) line number<br>
(b) pos_start, pos_end<br>
(c) string_view (optional)</p>
<h2 id="function-overloadings-of-node-data-construction">Function Overloadings of Node Data Construction</h2>
<p>Every node construction method has four function overloadings.<br>
For example, to construct a Lnast_node with a type of reference,<br>
we could use one of the following functions:</p>
<pre class="highlight tab tab-cpp"><code><span class="hljs-comment">// C++</span>
<span class="hljs-keyword">auto</span> node_ref = Lnast_node::create_ref(<span class="hljs-string">"foo"</span>);     
<span class="hljs-keyword">auto</span> node_ref = Lnast_node::create_ref(<span class="hljs-string">"foo"</span>, line_num);     
<span class="hljs-keyword">auto</span> node_ref = Lnast_node::create_ref(<span class="hljs-string">"foo"</span>, line_num, pos1, pos2);     
<span class="hljs-keyword">auto</span> node_ref = Lnast_node::create_ref(token);   
</code></pre>
<p>In case (1), you only knows the variable name is &quot;foo&quot;.<br>
In case (2), you know the variable name and the corresponding line number.<br>
In case (3), you know the variable name, the line number, and the charactrer position.<br>
In case (4), you are building LNAST from your HDL AST and you already have the Token.<br>
The toke should have line number, positions, and string_view information.</p>
<h2 id="another-example">Another Example</h2>
<p>If you don't care the string_view to be stored in the lnast node, just leave it empty for set &quot;foo&quot; for it.
This is true for many of the operator node, for example, to build a node with type of assign.</p>
<pre class="highlight tab tab-cpp"><code><span class="hljs-comment">// C++</span>
<span class="hljs-keyword">auto</span> node_assign = Lnast_node::create_assign();   
<span class="hljs-keyword">auto</span> node_assign = Lnast_node::create_assign(line_num);     
<span class="hljs-keyword">auto</span> node_assign = Lnast_node::create_assign(line_num, pos1, pos2);   
<span class="hljs-keyword">auto</span> node_assign = Lnast_node::create_assign(token); <span class="hljs-comment">// The token is not necessary to have a string_view  </span>
</code></pre>
<h1 id="module-input--output--and-register-declaration">Module Input, Output, and Register Declaration</h1>
<p>In LNAST, all input/output/register are defined in the node type reference
with differenct prefix of string_view, &quot;$&quot; stands for input, &quot;%&quot; stands for
output, and &quot;#&quot; stands for register.</p>
<h2 id="input">Input</h2>
<pre class="highlight"><code>// Pyrope
foo = $a
</code></pre>
<pre class="highlight tab tab-verilog"><code><span class="hljs-comment">// Verilog</span>
<span class="hljs-keyword">input</span> a;
</code></pre>
<pre class="highlight tab tab-cpp"><code><span class="hljs-comment">// C++</span>
<span class="hljs-keyword">auto</span> node_input = Lnast_node::create_ref(<span class="hljs-string">"$a"</span>, line_num, pos1, pos2);
</code></pre>
<h2 id="output">Output</h2>
<pre class="highlight"><code>// Pyrope
%out
</code></pre>
<pre class="highlight tab tab-verilog"><code><span class="hljs-comment">// Verilog</span>
<span class="hljs-keyword">output</span> out;
</code></pre>
<pre class="highlight tab tab-cpp"><code><span class="hljs-comment">// C++</span>
<span class="hljs-keyword">auto</span> node_output = Lnast_node::create_ref(<span class="hljs-string">"%out"</span>, line_num, pos1, pos2);
</code></pre>
<h2 id="register">Register</h2>
<pre class="highlight"><code>// Pyrope
#reg_foo
</code></pre>
<pre class="highlight tab tab-verilog"><code><span class="hljs-comment">// Verilog</span>
<span class="hljs-keyword">reg</span> reg_foo;
</code></pre>
<pre class="highlight tab tab-cpp"><code><span class="hljs-comment">// C++</span>
<span class="hljs-keyword">auto</span> node_reg = Lnast_node::create_ref(<span class="hljs-string">"#reg_foo"</span>, line_num, pos1, pos2);
</code></pre>
<h1 id="assign-statement">Assign Statement</h1>
<p>LNAST has 3 types of assignments. &quot;=&quot;, &quot;as&quot;, and &quot;:=&quot;.</p>
<ul>
<li>The &quot;lhs = rhs&quot; assignment (assign), copies the rhs value to the lhs and makes sure
that there is no bit drop. The lhs has to have equal or more bits than the
rhs.</li>
<li>The &quot;lhs as rhs&quot; assignment (as) is the same as the &quot;=&quot; assignment but it fixes
the value. The lhs variable becomes a &quot;C++ const&quot; after the assignment. The
value assigned can not change again.</li>
<li>the &quot;lhs := rhs&quot; assignment (dp_assign) is like the &quot;=&quot; assignment but there is no check
for overflow. If the rhs has more bits than the lhs, the upper bits will be
dropped.</li>
</ul>
<h2 id="assign-trivial-constant">Assign Trivial Constant</h2>
<pre class="highlight"><code>// Pyrope
val = 1023u10bits
</code></pre>
<pre class="highlight tab tab-verilog"><code><span class="hljs-comment">// Verilog</span>
<span class="hljs-keyword">assign</span> val = <span class="hljs-number">10</span><span class="hljs-meta">`d1023 // val has 10 bits</span>
</code></pre>
<pre class="highlight tab tab-shell"><code>// CFG
1       0       0       SEQ0
2       1       0       0       10      =       val     0d1023u10
</code></pre>
<pre class="highlight tab tab-cpp"><code><span class="hljs-comment">// C++</span>
<span class="hljs-keyword">auto</span> node_stmts  = Lnast_node::create_stmts  (<span class="hljs-string">"foo"</span>, line_num, pos1, pos2); 
<span class="hljs-keyword">auto</span> node_assign = Lnast_node::create_assign (<span class="hljs-string">"foo"</span>, line_num, pos1, pos2); 
<span class="hljs-keyword">auto</span> node_target = Lnast_node::create_ref    (<span class="hljs-string">"val"</span>, line_num, pos1, pos2);
<span class="hljs-keyword">auto</span> node_const  = Lnast_node::create_const  (<span class="hljs-string">"0d1023u10"</span>, line_num, pos1, pos2);

<span class="hljs-keyword">auto</span> idx_stmts  = lnast-&gt;add_child(idx_root,   node_stmts);
<span class="hljs-keyword">auto</span> idx_assign = lnast-&gt;add_child(idx_stmts,  node_assign);
<span class="hljs-keyword">auto</span> idx_target = lnast-&gt;add_child(idx_assign, node_target);
<span class="hljs-keyword">auto</span> idx_const  = lnast-&gt;add_child(idx_assign, node_const);
</code></pre>
<p><img src="source/graphviz/assign_trivial_constant.png" alt="assign">
An assign node sets the right hand side value to the reference pointed by the left hand side<br>
of the expression. The left hand side is always a reference. The right hand side is a reference or a constant.</p>
<h2 id="assign-simple-expression">Assign Simple Expression</h2>
<pre class="highlight"><code>// Pyrope
total := (x - 1) + 3 + 2
</code></pre>
<pre class="highlight tab tab-verilog"><code><span class="hljs-comment">// Verilog</span>
<span class="hljs-keyword">assign</span> total = (x - <span class="hljs-number">1</span>) + <span class="hljs-number">3</span> + <span class="hljs-number">2</span>
</code></pre>
<pre class="highlight tab tab-shell"><code>// CFG
1       0       0       SEQ0
2       1       0       0       21      -       ___a    x       0d1
3       1       1       0       21      +       ___b    ___a    0d3    0d2
4       1       3       0       21      =       total   ___b

</code></pre>
<pre class="highlight tab tab-cpp"><code><span class="hljs-comment">// C++</span>

<span class="hljs-comment">// preparing lnast_node data</span>
<span class="hljs-comment">// Note: as mentioned in the introduction, if you have the HDL-AST in hand, using</span>
<span class="hljs-comment">// Token directly instead of explicit string, line_num, pos ... etc.</span>

<span class="hljs-keyword">auto</span> node_stmts  = Lnast_node::create_stmts     (<span class="hljs-string">"foo"</span>,  line_num, pos1, pos2); 
node node_minus  = Lnast_node::create_minus     (<span class="hljs-string">"foo"</span>,  line_num, pos1, pos2);
node node_lhs1   = Lnast_node::create_ref       (<span class="hljs-string">"___a"</span>, line_num, pos1, pos2);
node node_op1    = Lnast_node::create_ref       (<span class="hljs-string">"x"</span>,    line_num, pos1, pos2);
node node_op2    = Lnast_node::create_const     (<span class="hljs-string">"0d1"</span>,  line_num, pos1, pos2);

node node_plus   = Lnast_node::create_plus      (<span class="hljs-string">"bar"</span>,  line_num, pos1, pos2);
node node_lhs2   = Lnast_node::create_ref       (<span class="hljs-string">"___b"</span>, line_num, pos1, pos2);
node node_op3    = Lnast_node::create_ref       (<span class="hljs-string">"___a"</span>, line_num, pos1, pos2);
node node_op4    = Lnast_node::create_const     (<span class="hljs-string">"0d3"</span>,  line_num, pos1, pos2);
node node_op5    = Lnast_node::create_const     (<span class="hljs-string">"0d2"</span>,  line_num, pos1, pos2);

<span class="hljs-keyword">auto</span> node_dpa    = Lnast_node::create_dp_assign (<span class="hljs-string">"foo2"</span>,  line_num, pos1, pos2); 
<span class="hljs-keyword">auto</span> node_lhs3   = Lnast_node::create_ref       (<span class="hljs-string">"total"</span>, line_num, pos1, pos2);
<span class="hljs-keyword">auto</span> node_op6    = Lnast_node::create_ref       (<span class="hljs-string">"___b"</span>,  line_num, pos1, pos2);

<span class="hljs-comment">// construct the LNAST tree </span>
<span class="hljs-keyword">auto</span> idx_stmts   = lnast-&gt;add_child(idx_root,  node_stmts);
<span class="hljs-keyword">auto</span> idx_minus   = lnast-&gt;add_child(idx_stmts, node_minus);
<span class="hljs-keyword">auto</span> idx_lhs1    = lnast-&gt;add_child(idx_minus, node_lhs1);
<span class="hljs-keyword">auto</span> idx_op1     = lnast-&gt;add_child(idx_minus, node_op1);        
<span class="hljs-keyword">auto</span> idx_op2     = lnast-&gt;add_child(idx_minus, node_op2);        

<span class="hljs-keyword">auto</span> idx_plus    = lnast-&gt;add_child(idx_stmts, node_plus);
<span class="hljs-keyword">auto</span> idx_lhs2    = lnast-&gt;add_child(idx_plus,  node_lhs2);
<span class="hljs-keyword">auto</span> idx_op3     = lnast-&gt;add_child(idx_plus,  node_op3);        
<span class="hljs-keyword">auto</span> idx_op4     = lnast-&gt;add_child(idx_plus,  node_op4);        
<span class="hljs-keyword">auto</span> idx_op5     = lnast-&gt;add_child(idx_plus,  node_op5);        

<span class="hljs-keyword">auto</span> idx_assign  = lnast-&gt;add_child(idx_stmts,  node_dpa);
<span class="hljs-keyword">auto</span> idx_lhs3    = lnast-&gt;add_child(idx_assign, node_lhs3);
<span class="hljs-keyword">auto</span> idx_op6     = lnast-&gt;add_child(idx_assign, node_op6);        
</code></pre>
<p><img src="source/graphviz/assign_simple_expression.png" alt="assign">
statements that have operations must breakdown the operations per type, and then assign the temporal value to the assign node.</p>
<h1 id="unary-operation-statement">Unary Operation Statement</h1>
<p>Unary operator is embedded as the prefix of the variable string_view</p>
<h2 id="binary-not-operation">Binary Not Operation</h2>
<pre class="highlight"><code>// Pyrope
%out = ~$inp
</code></pre>
<pre class="highlight tab tab-verilog"><code><span class="hljs-comment">// Verilog</span>
<span class="hljs-keyword">input</span>       inp;
<span class="hljs-keyword">output</span> <span class="hljs-keyword">wire</span> out;

<span class="hljs-keyword">assign</span> out = ~inp;
</code></pre>
<pre class="highlight tab tab-shell"><code>1 0 0 SEQ0
2 1 1 0    10  ~ %out  <span class="hljs-variable">$inp</span>
</code></pre>
<pre class="highlight tab tab-cpp"><code><span class="hljs-comment">//C++</span>
<span class="hljs-keyword">auto</span> idx_not  = lnast-&gt;add_child(idx_not,    Lnast_node::create_not(token1));
<span class="hljs-keyword">auto</span> idx_lhs  = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref(token2)); <span class="hljs-comment">// string_view = %out</span>
<span class="hljs-keyword">auto</span> idx_op   = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref(token3)); <span class="hljs-comment">// string_view = $inp       </span>
</code></pre>
<p><img src="source/graphviz/inv.png" alt="assign"></p>
<h2 id="logical-not-operation">Logical Not Operation</h2>
<p>The not operation can be applied over logical values. Compares the input against zero to be true. The binary not
just toggles each bit.</p>
<pre class="highlight"><code>// Pyrope
%out = !$inp
</code></pre>
<pre class="highlight tab tab-verilog"><code><span class="hljs-comment">// Verilog</span>
<span class="hljs-keyword">input</span>       inp;
<span class="hljs-keyword">output</span> <span class="hljs-keyword">wire</span> out;

<span class="hljs-keyword">assign</span> out = !inp;
</code></pre>
<pre class="highlight tab tab-shell"><code>1 0 0 SEQ0
2 1 1 0    10  ! %out  <span class="hljs-variable">$inp</span>
</code></pre>
<pre class="highlight tab tab-cpp"><code><span class="hljs-comment">//C++</span>
<span class="hljs-keyword">auto</span> idx_not  = lnast-&gt;add_child(idx_logical_not, Lnast_node::create_logical_not(token1));
<span class="hljs-keyword">auto</span> idx_lhs  = lnast-&gt;add_child(idx_assign     , Lnast_node::create_ref        (token2)); <span class="hljs-comment">// string_view = %out</span>
<span class="hljs-keyword">auto</span> idx_op   = lnast-&gt;add_child(idx_assign     , Lnast_node::create_ref        (token3)); <span class="hljs-comment">// string_view = $inp       </span>
</code></pre>
<p><img src="source/graphviz/logical_inv.png" alt="assign"></p>
<h1 id="n-ary-operation-statement">N-ary Operation Statement</h1>
<p>N-ary operation computes n rhs operands and assign the result to the lhs.
The n-ary operator group includes</p>
<table>
<thead>
<tr>
<th style="text-align:center">Operator</th>
<th style="text-align:center">Syntax</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">And</td>
<td style="text-align:center">&amp;</td>
</tr>
<tr>
<td style="text-align:center">Or</td>
<td style="text-align:center">|</td>
</tr>
<tr>
<td style="text-align:center">Xor</td>
<td style="text-align:center">^</td>
</tr>
<tr>
<td style="text-align:center">Logical And</td>
<td style="text-align:center">and</td>
</tr>
<tr>
<td style="text-align:center">Logical Or</td>
<td style="text-align:center">or</td>
</tr>
<tr>
<td style="text-align:center">Plus</td>
<td style="text-align:center">+</td>
</tr>
<tr>
<td style="text-align:center">Minus</td>
<td style="text-align:center">-</td>
</tr>
<tr>
<td style="text-align:center">Multiply</td>
<td style="text-align:center">*</td>
</tr>
<tr>
<td style="text-align:center">Division</td>
<td style="text-align:center">/</td>
</tr>
<tr>
<td style="text-align:center">Equals to</td>
<td style="text-align:center">==</td>
</tr>
<tr>
<td style="text-align:center">Less than</td>
<td style="text-align:center">&lt;</td>
</tr>
<tr>
<td style="text-align:center">Less than or Equals to</td>
<td style="text-align:center">&lt;=</td>
</tr>
<tr>
<td style="text-align:center">Greater than</td>
<td style="text-align:center">&gt;</td>
</tr>
<tr>
<td style="text-align:center">Greater than or Equals to</td>
<td style="text-align:center">&gt;=</td>
</tr>
<tr>
<td style="text-align:center">Tuple concatenation</td>
<td style="text-align:center">++</td>
</tr>
</tbody>
</table>
<p>We take the &quot;And Operator&quot; for explaination.</p>
<h2 id="and-operation">And Operation</h2>
<pre class="highlight"><code>// Pyrope
out = a &amp; b &amp; c
</code></pre>
<pre class="highlight tab tab-verilog"><code><span class="hljs-comment">// Verilog</span>
<span class="hljs-keyword">assign</span> out = a &amp; b &amp; c
</code></pre>
<pre class="highlight tab tab-shell"><code>// CFG
1       0       0       SEQ0
2       1       0       0       21      &amp;       ___a    a       b      c
3       1       3       0       21      =       out     ___a

</code></pre>
<pre class="highlight tab tab-cpp"><code><span class="hljs-comment">// C++</span>
<span class="hljs-keyword">auto</span> idx_stmts  = lnast-&gt;add_child(idx_root,  Lnast_node::create_stmts(token0));
<span class="hljs-keyword">auto</span> idx_and    = lnast-&gt;add_child(idx_stmts, Lnast_node::create_and  (token1)); <span class="hljs-comment">// string_view = ___a</span>
<span class="hljs-keyword">auto</span> idx_lhs1   = lnast-&gt;add_child(idx_and,   Lnast_node::create_ref  (token2)); <span class="hljs-comment">// string_view = a</span>
<span class="hljs-keyword">auto</span> idx_op1    = lnast-&gt;add_child(idx_and,   Lnast_node::create_ref  (token3)); <span class="hljs-comment">// string_view = b       </span>
<span class="hljs-keyword">auto</span> idx_op2    = lnast-&gt;add_child(idx_and,   Lnast_node::create_ref  (token4)); <span class="hljs-comment">// string_view = c       </span>

<span class="hljs-keyword">auto</span> idx_assign = lnast-&gt;add_child(idx_stmts,  Lnast_node::create_assign(token5));
<span class="hljs-keyword">auto</span> idx_lhs2   = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref   (token6)); <span class="hljs-comment">// string_view = out</span>
<span class="hljs-keyword">auto</span> idx_op3    = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref   (token7)); <span class="hljs-comment">// string_view = ___a       </span>
</code></pre>
<p><img src="source/graphviz/and.png" alt="assign"></p>
<h1 id="if-statement">If Statement</h1>
<h2 id="simple-case">Simple Case</h2>
<pre class="highlight"><code>if a &gt; 3 {
  b = a + 1
} 
</code></pre>
<pre class="highlight tab tab-shell"><code>// CFG
1  0  0  SEQ0                      
2  1  0  0     24  <span class="hljs-keyword">if</span>  ___a        
3  2  0  SEQ1                      
4  3  0  0     24  &gt;   ___a  a     0d3
6  2  0  SEQ2                      
7  6  0  0     24  +   ___b  a     0d1
8  6  1  0     24  =   a     ___b  
</code></pre>
<pre class="highlight tab tab-verilog"><code><span class="hljs-keyword">assign</span> b2 = (a &gt; <span class="hljs-number">3</span>) ? a - <span class="hljs-number">1</span> : b; 
</code></pre>
<pre class="highlight tab tab-cpp"><code><span class="hljs-comment">//C++ </span>

<span class="hljs-keyword">auto</span> idx_stmts0 = lnast-&gt;add_child(idx_root,   Lnast_node::create_stmts (token_0)); 
<span class="hljs-keyword">auto</span> idx_if     = lnast-&gt;add_child(idx_stmts0, Lnast_node::create_if    (token_1)); 

<span class="hljs-keyword">auto</span> idx_cstmts = lnast-&gt;add_child(idx_if,     Lnast_node::create_cstmts(token_2)); 
<span class="hljs-keyword">auto</span> idx_gt     = lnast-&gt;add_child(idx_cstmts, Lnast_node::create_gt    (token_3)); 
<span class="hljs-keyword">auto</span> idx_lhs    = lnast-&gt;add_child(idx_gt,     Lnast_node::create_ref   (token_4)); <span class="hljs-comment">//string_view = "___a"</span>
<span class="hljs-keyword">auto</span> idx_op1    = lnast-&gt;add_child(idx_gt,     Lnast_node::create_ref   (token_5)); <span class="hljs-comment">//string_view = "a"</span>
<span class="hljs-keyword">auto</span> idx_op2    = lnast-&gt;add_child(idx_gt,     Lnast_node::create_const (token_6)); <span class="hljs-comment">//string_view = "0d3"</span>

<span class="hljs-keyword">auto</span> idx_cond1  = lnast-&gt;add_child(idx_if,     Lnast_node::create_cond  (token_7)); <span class="hljs-comment">//string_view = "___a"</span>

<span class="hljs-keyword">auto</span> idx_stmts1 = lnast-&gt;add_child(idx_if,     Lnast_node::create_stmts (token_8));
<span class="hljs-keyword">auto</span> idx_plus   = lnast-&gt;add_child(idx_stmts1, Lnast_node::create_plus  (token_9));
<span class="hljs-keyword">auto</span> idx_lhs    = lnast-&gt;add_child(idx_plus,   Lnast_node::create_ref   (token_a)); <span class="hljs-comment">//string_view = "___b"</span>
<span class="hljs-keyword">auto</span> idx_op3    = lnast-&gt;add_child(idx_plus,   Lnast_node::create_ref   (token_b)); <span class="hljs-comment">//string_view = "a"</span>
<span class="hljs-keyword">auto</span> idx_op4    = lnast-&gt;add_child(idx_plus,   Lnast_node::create_const (token_c)); <span class="hljs-comment">//string_view = "0d1"</span>

<span class="hljs-keyword">auto</span> idx_assign = lnast-&gt;add_child(idx_stmts1, Lnast_node::create_assign(token_d)); 
<span class="hljs-keyword">auto</span> idx_lhs    = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref   (token_e)); <span class="hljs-comment">//string_view = "a"</span>
<span class="hljs-keyword">auto</span> idx_op5    = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref   (token_f)); <span class="hljs-comment">//string_view = "___b"</span>

</code></pre>
<p><img src="source/graphviz/simple_if.png" alt="assign">
An if-subtree consisted of conditional-statements sub-trees, boolean condition nodes, and statements
sub-trees in the following order:</p>
<p>cstmts1 -&gt; condition1 -&gt; stmts1 -&gt; cstmts2 -&gt; condition2 -&gt; stmts2 ...-&gt; stmtsN,</p>
<p>If there is a final &quot;else&quot; chunk, it won't come with a corresponding conditionial
statements sub-tree and conditional node, see the figure for the detail.</p>
<h2 id="full-case">Full Case</h2>
<pre class="highlight"><code>// Pyrope
if a &gt; 10 {
  b = 3 
} elif a &lt; 1 {
  b = 2
} else {
  b = 1
}
</code></pre>
<pre class="highlight tab tab-verilog"><code><span class="hljs-comment">// Verilog</span>

<span class="hljs-keyword">assign</span> b = (a &gt; <span class="hljs-number">10</span>) ? <span class="hljs-number">3</span> :
           (a &lt; <span class="hljs-number">1</span> ) ? <span class="hljs-number">2</span> : <span class="hljs-number">1</span> ;

</code></pre>
<pre class="highlight tab tab-shell"><code>// CFG 
1   0   0  SEQ0                       
2   1   0  0     62  <span class="hljs-keyword">if</span>    ___a       
3   2   0  SEQ1                       
4   3   0  0     62  &gt;     ___a  a    0d10
6   2   0  SEQ2                       
7   6   0  0     62  =     b     0d3  
9   2   2  0     62  <span class="hljs-keyword">elif</span>  ___b       
10  2   0  SEQ3                       
11  10  0  0     62  &lt;     ___b  a    0d1
13  2   0  SEQ4                       
14  13  0  0     62  =     b     0d2  
16  2   0  SEQ5                       
17  16  0  0     62  =     b     0d1  
</code></pre>
<pre class="highlight tab tab-cpp"><code><span class="hljs-comment">//C++ </span>
<span class="hljs-keyword">auto</span> idx_stmts0  = lnast-&gt;add_child(idx_root,   Lnast_node::create_stmts (token_0));
<span class="hljs-keyword">auto</span> idx_if      = lnast-&gt;add_child(idx_stmts0, Lnast_node::create_if    (token_1));

<span class="hljs-keyword">auto</span> idx_cstmts1 = lnast-&gt;add_child(idx_if,     Lnast_node::create_cstmts(token_2));
<span class="hljs-keyword">auto</span> idx_gt      = lnast-&gt;add_child(idx_cstmts, Lnast_node::create_gt    (token_3)); 
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_gt,     Lnast_node::create_ref   (token_4)); <span class="hljs-comment">//string_view = "___a"</span>
<span class="hljs-keyword">auto</span> idx_op1     = lnast-&gt;add_child(idx_gt,     Lnast_node::create_ref   (token_5)); <span class="hljs-comment">//string_view = "a"</span>
<span class="hljs-keyword">auto</span> idx_op2     = lnast-&gt;add_child(idx_gt,     Lnast_node::create_const (token_6)); <span class="hljs-comment">//string_view = "0d10"</span>

<span class="hljs-keyword">auto</span> idx_cond1   = lnast-&gt;add_child(idx_if,     Lnast_node::create_cond  (token_7)); <span class="hljs-comment">//string_view = "___a"</span>

<span class="hljs-keyword">auto</span> idx_stmts1  = lnast-&gt;add_child(idx_if,     Lnast_node::create_stmts (token_8));
<span class="hljs-keyword">auto</span> idx_assign  = lnast-&gt;add_child(idx_stmts1, Lnast_node::create_assign(token_9));
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref   (token_a)); <span class="hljs-comment">//string_view = "b"</span>
<span class="hljs-keyword">auto</span> idx_op1     = lnast-&gt;add_child(idx_assign, Lnast_node::create_const (token_b)); <span class="hljs-comment">//string_view = "0d3"</span>

<span class="hljs-keyword">auto</span> idx_cstmts2 = lnast-&gt;add_child(idx_if,     Lnast_node::create_cstmts(token_c));
<span class="hljs-keyword">auto</span> idx_lt      = lnast-&gt;add_child(idx_cstmts, Lnast_node::create_lt    (token_d)); 
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_lt,     Lnast_node::create_ref   (token_e)); <span class="hljs-comment">//string_view = "___b"</span>
<span class="hljs-keyword">auto</span> idx_op2     = lnast-&gt;add_child(idx_lt,     Lnast_node::create_ref   (token_f)); <span class="hljs-comment">//string_view = "a"</span>
<span class="hljs-keyword">auto</span> idx_op3     = lnast-&gt;add_child(idx_lt,     Lnast_node::create_const (token_g)); <span class="hljs-comment">//string_view = "0d1"</span>

<span class="hljs-keyword">auto</span> idx_cond2   = lnast-&gt;add_child(idx_if,     Lnast_node::create_cond  (token_h)); <span class="hljs-comment">//string_view = "___b"</span>

<span class="hljs-keyword">auto</span> idx_stmts2  = lnast-&gt;add_child(idx_if,     Lnast_node::create_stmts (token_i));
<span class="hljs-keyword">auto</span> idx_assign  = lnast-&gt;add_child(idx_stmts2, Lnast_node::create_assign(token_j));
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref   (token_k)); <span class="hljs-comment">//string_view = "b"</span>
<span class="hljs-keyword">auto</span> idx_op4     = lnast-&gt;add_child(idx_assign, Lnast_node::create_const (token_l)); <span class="hljs-comment">//string_view = "0d2"</span>
    
<span class="hljs-keyword">auto</span> idx_stmts3  = lnast-&gt;add_child(idx_if,     Lnast_node::create_stmts (token_m));
<span class="hljs-keyword">auto</span> idx_assign  = lnast-&gt;add_child(idx_stmts3, Lnast_node::create_assign(token_n));
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref   (token_o)); <span class="hljs-comment">//string_view = "b"</span>
<span class="hljs-keyword">auto</span> idx_op5     = lnast-&gt;add_child(idx_assign, Lnast_node::create_const (token_p)); <span class="hljs-comment">//string_view = "0d3"</span>

</code></pre>
<p><img src="source/graphviz/full_case_if.png" alt="assign"></p>
<h1 id="tuple-statement">Tuple Statement</h1>
<pre class="highlight"><code>// Pyrope
tup = (foo = 1, bar = cat + 2)
</code></pre>
<pre class="highlight tab tab-verilog"><code><span class="hljs-comment">// Verilog</span>
typede <span class="hljs-keyword">packed</span> {
  <span class="hljs-keyword">logic</span>  foo;
  <span class="hljs-keyword">logic</span> [<span class="hljs-number">4</span>:<span class="hljs-number">0</span>]  bar;
} tup_t;

tup_t tup;

<span class="hljs-keyword">always_comb</span> <span class="hljs-keyword">begin</span>
  tup<span class="hljs-variable">.foo</span> = <span class="hljs-number">1</span>;
  tup<span class="hljs-variable">.bar</span> = cat + <span class="hljs-number">2</span>;
<span class="hljs-keyword">end</span>
</code></pre>
<pre class="highlight tab tab-shell"><code>// CFG 
// FIXME: SH: <span class="hljs-built_in">wait</span> Akash to change tuple expression scope
1       0       x       SEQ0
4       1       x       0       33      +       ___d    cat     0d2
2       1       x       TUP0    ___a
3       2       x       0       33      =       foo     0d1
5       2       x       0       33      =       bar     ___d
7       1       x       0       33      =       tup     ___a
</code></pre>
<pre class="highlight tab tab-cpp"><code><span class="hljs-comment">//C++ </span>
<span class="hljs-keyword">auto</span> idx_plus    = lnast-&gt;add_child(idx_stmts0, Lnast_node::create_plus    (token_1)); 
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_plus,   Lnast_node::create_ref     (token_2)); <span class="hljs-comment">//string_view = "___d"</span>
<span class="hljs-keyword">auto</span> idx_op1     = lnast-&gt;add_child(idx_plus,   Lnast_node::create_ref     (token_3)); <span class="hljs-comment">//string_view = "cat"</span>
<span class="hljs-keyword">auto</span> idx_op2     = lnast-&gt;add_child(idx_plus,   Lnast_node::create_const   (token_4)); <span class="hljs-comment">//string_view = "0d2"</span>

<span class="hljs-keyword">auto</span> idx_tup     = lnast-&gt;add_child(idx_stmts0, Lnast_node::create_tuple   (token_5)); 
<span class="hljs-keyword">auto</span> idx_tname   = lnast-&gt;add_child(idx_tup,    Lnast_node::create_ref     (token_6)); <span class="hljs-comment">//string_view = "tup"</span>
<span class="hljs-keyword">auto</span> idx_assign  = lnast-&gt;add_child(idx_tup,    Lnast_node::create_assign  (token_7));
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref     (token_8)); <span class="hljs-comment">//string_view = "foo"</span>
<span class="hljs-keyword">auto</span> idx_op3     = lnast-&gt;add_child(idx_assign, Lnast_node::create_const   (token_9)); <span class="hljs-comment">//string_view = "0d1"</span>

<span class="hljs-keyword">auto</span> idx_assign  = lnast-&gt;add_child(idx_tup,    Lnast_node::create_assign  (token_a));
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref     (token_b)); <span class="hljs-comment">//string_view = "bar"</span>
<span class="hljs-keyword">auto</span> idx_op4     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref     (token_c)); <span class="hljs-comment">//string_view = "___d"</span>
</code></pre>
<p><img src="source/graphviz/tuple.png" alt="assign"></p>
<h2 id="tuple-concatenation-statement">Tuple Concatenation Statement</h2>
<pre class="highlight"><code>// Pyrope
tup = (foo = 1, bar = cat + 2) 
tup = tup ++ (4, dog)

</code></pre>
<pre class="highlight tab tab-verilog"><code><span class="hljs-comment">// Verilog</span>

</code></pre>
<pre class="highlight tab tab-shell"><code>// CFG 
1       0       x       SEQ0
4       1       x       0       33      +       ___d    cat     0d2
2       1       x       TUP0    tup
3       2       x       0       33      =       foo     0d1
5       2       x       0       33      =       bar     ___d
7       1       x       TUP1    ___f
8       7       x       35      54      =       null    0d4
9       7       x       35      54      =       null    dog
10      1       x       35      54      ++      ___e    tup     ___f
11      1       x       35      54      =       tup     ___e
</code></pre>
<pre class="highlight tab tab-cpp"><code><span class="hljs-comment">//C++ </span>
<span class="hljs-keyword">auto</span> idx_plus    = lnast-&gt;add_child(idx_stmts0, Lnast_node::create_plus    (token_1)); 
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_plus,   Lnast_node::create_ref     (token_2)); <span class="hljs-comment">//string_view = "___d"</span>
<span class="hljs-keyword">auto</span> idx_op1     = lnast-&gt;add_child(idx_plus,   Lnast_node::create_ref     (token_3)); <span class="hljs-comment">//string_view = "cat"</span>
<span class="hljs-keyword">auto</span> idx_op2     = lnast-&gt;add_child(idx_plus,   Lnast_node::create_const   (token_4)); <span class="hljs-comment">//string_view = "0d2"</span>

<span class="hljs-keyword">auto</span> idx_tup     = lnast-&gt;add_child(idx_stmts0, Lnast_node::create_tuple   (token_5)); 
<span class="hljs-keyword">auto</span> idx_tname   = lnast-&gt;add_child(idx_tup,    Lnast_node::create_ref     (token_6)); <span class="hljs-comment">//string_view = "tup"</span>

<span class="hljs-keyword">auto</span> idx_assign  = lnast-&gt;add_child(idx_tup,    Lnast_node::create_assign  (token_7));
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref     (token_8)); <span class="hljs-comment">//string_view = "foo"</span>
<span class="hljs-keyword">auto</span> idx_op3     = lnast-&gt;add_child(idx_assign, Lnast_node::create_const   (token_9)); <span class="hljs-comment">//string_view = "0d1"</span>

<span class="hljs-keyword">auto</span> idx_assign  = lnast-&gt;add_child(idx_tup,    Lnast_node::create_assign  (token_a));
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref     (token_b)); <span class="hljs-comment">//string_view = "bar"</span>
<span class="hljs-keyword">auto</span> idx_op4     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref     (token_c)); <span class="hljs-comment">//string_view = "___d"</span>


<span class="hljs-keyword">auto</span> idx_tup2    = lnast-&gt;add_child(idx_stmts0, Lnast_node::create_tuple   (token_g))
<span class="hljs-keyword">auto</span> idx_tname   = lnast-&gt;add_child(idx_tup2,   Lnast_node::create_ref     (token_h)); <span class="hljs-comment">//string_view = "___f", for intermediate temp tuple</span>
<span class="hljs-keyword">auto</span> idx_assign  = lnast-&gt;add_child(idx_tup2,   Lnast_node::create_assign  (token_h));
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref     (token_i)); <span class="hljs-comment">//string_view = "null"</span>
<span class="hljs-keyword">auto</span> idx_op7     = lnast-&gt;add_child(idx_assign, Lnast_node::create_const   (token_j)); <span class="hljs-comment">//string_view = "0d4"</span>

<span class="hljs-keyword">auto</span> idx_assign  = lnast-&gt;add_child(idx_tup2,   Lnast_node::create_assign  (token_k));
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref     (token_l)); <span class="hljs-comment">//string_view = "null"</span>
<span class="hljs-keyword">auto</span> idx_op8     = lnast-&gt;add_child(idx_assign, Lnast_node::create_reg     (token_m)); <span class="hljs-comment">//string_view = "dog"</span>


<span class="hljs-keyword">auto</span> idx_tconcat = lnast-&gt;add_child(idx_stmts0,  Lnast_node::create_tuple_concat (token_p)); 
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_tconcat, Lnast_node::create_ref    (token_q)); <span class="hljs-comment">//string_view = "___e"</span>
<span class="hljs-keyword">auto</span> idx_op9     = lnast-&gt;add_child(idx_tconcat, Lnast_node::create_ref    (token_r)); <span class="hljs-comment">//string_view = "tup"</span>
<span class="hljs-keyword">auto</span> idx_opa     = lnast-&gt;add_child(idx_tconcat, Lnast_node::create_ref    (token_s)); <span class="hljs-comment">//string_view = "___f"</span>

<span class="hljs-keyword">auto</span> idx_assign  = lnast-&gt;add_child(idx_stmts0, Lnast_node::create_assign  (<span class="hljs-keyword">token_t</span>));
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref     (token_u)); <span class="hljs-comment">//string_view = "tup"</span>
<span class="hljs-keyword">auto</span> idx_opb     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref     (token_v)); <span class="hljs-comment">//string_view = "___e"</span>

</code></pre>
<p><img src="source/graphviz/tuple_concat.png" alt="assign"></p>
<h1 id="for-loop-statement">For Loop Statement</h1>
<pre class="highlight"><code>// Pyrope
for i in (0..3) {
  tuple_foo[i] = tuple_bar[3-i]
}

</code></pre>
<pre class="highlight tab tab-verilog"><code><span class="hljs-comment">// Verilog</span>
</code></pre>
<pre class="highlight tab tab-shell"><code>// CFG 
// FIXME: SH: still need to check with new CFG from Akash
1       0       x       SEQ0
2       1       0       TUP0    ___b
3       2       0       0       51      ..      ___c    0d0     0d3
5       1       2       0       51      <span class="hljs-keyword">for</span>     i       ___b
7       5       0       SEQ1
8       7       0       0       51      []      ___d    tuple_foo       i
9       7       1       0       51      -       ___g    0d3     i
10      7       2       0       51      []      ___f    tuple_bar       ___g
11      7       3       0       51      .()     ___e    ___f
12      7       4       0       51      =       ___d    ___e
</code></pre>
<pre class="highlight tab tab-cpp"><code><span class="hljs-comment">//C++ </span>

<span class="hljs-keyword">auto</span> idx_tup     = lnast-&gt;add_child(idx_stmts0, Lnast_node::create_tuple  (token_1)); 
<span class="hljs-keyword">auto</span> idx_tname   = lnast-&gt;add_child(idx_tup,    Lnast_node::create_ref    (token_2)); <span class="hljs-comment">//string_view = "___b"</span>

<span class="hljs-keyword">auto</span> idx_assign  = lnast-&gt;add_child(idx_tup,    Lnast_node::create_assign (token_3));
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref    (token_4)); <span class="hljs-comment">//string_view = "__range_begin"</span>
<span class="hljs-keyword">auto</span> idx_op3     = lnast-&gt;add_child(idx_assign, Lnast_node::create_const  (token_5)); <span class="hljs-comment">//string_view = "0d0"</span>

<span class="hljs-keyword">auto</span> idx_assign  = lnast-&gt;add_child(idx_tup,    Lnast_node::create_assign (token_6));
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref    (token_7)); <span class="hljs-comment">//string_view = "__range_end"</span>
<span class="hljs-keyword">auto</span> idx_op3     = lnast-&gt;add_child(idx_assign, Lnast_node::create_const  (token_8)); <span class="hljs-comment">//string_view = "0d3"</span>

<span class="hljs-keyword">auto</span> idx_for       = lnast-&gt;add_child(idx_stmts0, Lnast_node::create_for  (token_9));
<span class="hljs-keyword">auto</span> idx_stmts1    = lnast-&gt;add_child(idx_for,    Lnast_node::create_stmts(token_a)); 
<span class="hljs-keyword">auto</span> idx_itr       = lnast-&gt;add_child(idx_for,    Lnast_node::create_ref  (token_b)); <span class="hljs-comment">//string_view = "i"</span>
<span class="hljs-keyword">auto</span> idx_itr_range = lnast-&gt;add_child(idx_for,    Lnast_node::create_ref  (token_c)); <span class="hljs-comment">//string_view = "___b"</span>

<span class="hljs-keyword">auto</span> idx_select  = lnast-&gt;add_child(idx_stmts1, Lnast_node::create_select (token_d));  
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_select, Lnast_node::create_ref    (token_e)); <span class="hljs-comment">//string_view = "___d"</span>
<span class="hljs-keyword">auto</span> idx_op4     = lnast-&gt;add_child(idx_select, Lnast_node::create_ref    (token_f)); <span class="hljs-comment">//string_view = "tup_foo"</span>
<span class="hljs-keyword">auto</span> idx_op5     = lnast-&gt;add_child(idx_select, Lnast_node::create_ref    (token_g)); <span class="hljs-comment">//string_view = "i"</span>

<span class="hljs-keyword">auto</span> idx_minus   = lnast-&gt;add_child(idx_stmts1, Lnast_node::create_minus  (token_h));  
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_minus,  Lnast_node::create_ref    (token_i)); <span class="hljs-comment">//string_view = "___g"</span>
<span class="hljs-keyword">auto</span> idx_op6     = lnast-&gt;add_child(idx_minus,  Lnast_node::create_cond   (token_j)); <span class="hljs-comment">//string_view = "0d3"</span>
<span class="hljs-keyword">auto</span> idx_op7     = lnast-&gt;add_child(idx_minus,  Lnast_node::create_ref    (token_k)); <span class="hljs-comment">//string_view = "i"</span>

<span class="hljs-keyword">auto</span> idx_select  = lnast-&gt;add_child(idx_stmts1, Lnast_node::create_select (token_l));  
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_select, Lnast_node::create_ref    (token_m)); <span class="hljs-comment">//string_view = "___f"</span>
<span class="hljs-keyword">auto</span> idx_op8     = lnast-&gt;add_child(idx_select, Lnast_node::create_ref    (token_n)); <span class="hljs-comment">//string_view = "tup_bar"</span>
<span class="hljs-keyword">auto</span> idx_op9     = lnast-&gt;add_child(idx_select, Lnast_node::create_ref    (token_o)); <span class="hljs-comment">//string_view = "___g"</span>

<span class="hljs-keyword">auto</span> idx_assign  = lnast-&gt;add_child(idx_stmts1, Lnast_node::create_assign (token_p));
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref    (token_q)); <span class="hljs-comment">//string_view = "___d"</span>
<span class="hljs-keyword">auto</span> idx_opa     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref    (token_r)); <span class="hljs-comment">//string_view = "___f"</span>

</code></pre>
<p><img src="source/graphviz/for.png" alt="assign"></p>
<h1 id="while-loop-statement">While Loop Statement</h1>
<pre class="highlight"><code>// Pyrope
for i in (0..3) {
  tup_foo[i] = tup_bar[3-i]
}

</code></pre>
<pre class="highlight tab tab-verilog"><code><span class="hljs-comment">// Verilog</span>
</code></pre>
<pre class="highlight tab tab-shell"><code>// CFG 
1       0       0       SEQ0
2       1       0       0       58      &gt;       ___a    i       0d0
3       1       1       0       58      <span class="hljs-keyword">while</span>   ___a
5       3       0       SEQ1
6       5       0       0       58      []      ___b    tup_foo i
7       5       1       0       58      -       ___e    0d3     i
8       5       2       0       58      []      ___d    tup_bar ___e
9       5       4       0       58      =       ___b    ___d
10      5       5       0       58      -       ___f    i       0d1
11      5       6       0       58      =       i       ___f
</code></pre>
<pre class="highlight tab tab-cpp"><code><span class="hljs-comment">//C++ </span>
<span class="hljs-keyword">auto</span> idx_while   = lnast-&gt;add_child(idx_stmts0,  Lnast_node::create_while   (token_0));
<span class="hljs-keyword">auto</span> idx_cond    = lnast-&gt;add_child(idx_while,   Lnast_node::create_cond    (token_1)); <span class="hljs-comment">//string_view = "___a"</span>
<span class="hljs-keyword">auto</span> idx_stmts1  = lnast-&gt;add_child(idx_while,   Lnast_node::create_stmts   (token_2));
<span class="hljs-keyword">auto</span> idx_exp1    = lnast-&gt;add_child(idx_stmts1,  Lnast_node::create_select  (token_3)); <span class="hljs-comment">//string_view = "___b"</span>
.
.
.
</code></pre>
<p><img src="source/graphviz/while.png" alt="assign"></p>
<h1 id="function-definition-statement">Function Definition Statement</h1>
<h2 id="basic-function-definition">Basic Function Definition</h2>
<p>A function could be viewed as a module, the arguments of a function represent
the module IO with the io-prefix, $ for input or % for output.</p>
<p>In LNAST, a function definition statement is composed as the following node sequence:</p>
<p>function_name -&gt; condition -&gt; statements(function body) -&gt; io_1 -&gt; io_2 -&gt; io_N ...</p>
<pre class="highlight"><code>// Pyrope
func_xor = :($a, $b, %out):{
  %out = $a ^ $b
}

</code></pre>
<pre class="highlight tab tab-verilog"><code><span class="hljs-comment">// Verilog</span>
<span class="hljs-keyword">module</span> func_xor(
  <span class="hljs-keyword">input</span> a,
  <span class="hljs-keyword">input</span> b,
  outpout <span class="hljs-keyword">wire</span> out
);

  <span class="hljs-keyword">assign</span> out = a ^ b;

<span class="hljs-keyword">endmodule</span>

</code></pre>
<pre class="highlight tab tab-shell"><code>// CFG 
1  0  0  SEQ0                                    
2  1  0  0     47  ::{  ___a null <span class="hljs-variable">$a</span>  <span class="hljs-variable">$b</span>  %out
4  2  0  SEQ1                                    
5  4  0  0     47  ^    ___b      <span class="hljs-variable">$a</span>     <span class="hljs-variable">$b</span>      
6  4  1  0     47  =    %out      ___b           
7  1  1  0     47  =    func_xor  \___a          
</code></pre>
<pre class="highlight tab tab-cpp"><code><span class="hljs-comment">//C++ </span>
<span class="hljs-keyword">auto</span> idx_stmts0  = lnast-&gt;add_child(idx_root,   Lnast_node::create_stmts   (token_0));
<span class="hljs-keyword">auto</span> idx_func    = lnast-&gt;add_child(idx_stmts0, Lnast_node::create_func_def(token_1));

<span class="hljs-keyword">auto</span> idx_fname   = lnast-&gt;add_child(idx_func,   Lnast_node::create_ref     (token_2)); <span class="hljs-comment">//string_view = "func_xor"</span>
<span class="hljs-keyword">auto</span> idx_cond    = lnast-&gt;add_child(idx_func,   Lnast_node::create_cond    (token_3)); <span class="hljs-comment">//string_view = "true"</span>
<span class="hljs-keyword">auto</span> idx_stmts1  = lnast-&gt;add_child(idx_func,   Lnast_node::create_stmts   (token_4));
<span class="hljs-keyword">auto</span> idx_io1     = lnast-&gt;add_child(idx_func,   Lnast_node::create_ref     (token_5)); <span class="hljs-comment">//string_view = "$a"</span>
<span class="hljs-keyword">auto</span> idx_io2     = lnast-&gt;add_child(idx_func,   Lnast_node::create_ref     (token_6)); <span class="hljs-comment">//string_view = "$b"</span>
<span class="hljs-keyword">auto</span> idx_io3     = lnast-&gt;add_child(idx_func,   Lnast_node::create_ref     (token_7)); <span class="hljs-comment">//string_view = "$out"</span>

<span class="hljs-keyword">auto</span> idx_xor     = lnast-&gt;add_child(idx_stmts1, Lnast_node::create_xor     (token_7)); 
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_xor,    Lnast_node::create_ref     (token_8)); <span class="hljs-comment">//string_view = "___b"</span>
<span class="hljs-keyword">auto</span> idx_op1     = lnast-&gt;add_child(idx_xor,    Lnast_node::create_ref     (token_9)); <span class="hljs-comment">//string_view = "$a"</span>
<span class="hljs-keyword">auto</span> idx_op2     = lnast-&gt;add_child(idx_xor,    Lnast_node::create_ref     (token_a)); <span class="hljs-comment">//string_view = "$b"</span>

<span class="hljs-keyword">auto</span> idx_assign  = lnast-&gt;add_child(idx_stmts1, Lnast_node::create_assign  (token_b));
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref     (token_c)); <span class="hljs-comment">//string_view = "%out"</span>
<span class="hljs-keyword">auto</span> idx_op1     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref     (token_d)); <span class="hljs-comment">//string_view = "___b"</span>
</code></pre>
<p><img src="source/graphviz/function_def.png" alt="assign"></p>
<h2 id="conditional-function-definition">Conditional Function Definition</h2>
<p>If the HDL support the conditional function definition, for example, Pyrope, we
have to assign the appropriate condition variable to the condition node. In the
example of the following Pyrope code, the func_xor function will only be
declared when its intput $valid is true. For normal case, we assign &quot;true&quot;
string_view to this condition node. See figure for better understanding.</p>
<pre class="highlight"><code>// Pyrope
func_xor = :($a, $b, $valid, %out) when $valid:{
  %out = $a ^ $b
}

</code></pre>
<pre class="highlight tab tab-verilog"><code><span class="hljs-comment">// Verilog</span>
<span class="hljs-keyword">module</span> func_xor(
  <span class="hljs-keyword">input</span> a,
  <span class="hljs-keyword">input</span> b,
  outpout <span class="hljs-keyword">wire</span> out
);

  <span class="hljs-keyword">assign</span> out = a ^ b;

<span class="hljs-keyword">endmodule</span>

</code></pre>
<pre class="highlight tab tab-shell"><code>// CFG 
1  0  0  SEQ0                                    
2  1  0  0     47  ::{  ___a      <span class="hljs-variable">$valid</span>  <span class="hljs-variable">$a</span>  <span class="hljs-variable">$b</span>  <span class="hljs-variable">$valid</span> %out
4  2  0  SEQ1                                    
5  4  0  0     47  ^    ___b      <span class="hljs-variable">$a</span>     <span class="hljs-variable">$b</span>      
6  4  1  0     47  =    %out      ___b           
7  1  1  0     47  =    func_xor  \___a          
</code></pre>
<pre class="highlight tab tab-cpp"><code><span class="hljs-comment">//C++ </span>
<span class="hljs-keyword">auto</span> idx_stmts0  = lnast-&gt;add_child(idx_root,   Lnast_node::create_stmts   (token_0));
<span class="hljs-keyword">auto</span> idx_func    = lnast-&gt;add_child(idx_stmts0, Lnast_node::create_func_def(token_1));

<span class="hljs-keyword">auto</span> idx_fname   = lnast-&gt;add_child(idx_func,   Lnast_node::create_ref     (token_2)); <span class="hljs-comment">//string_view = "func_xor"</span>
<span class="hljs-keyword">auto</span> idx_cond    = lnast-&gt;add_child(idx_func,   Lnast_node::create_cond    (token_3)); <span class="hljs-comment">//string_view = "$valid"</span>
<span class="hljs-keyword">auto</span> idx_stmts1  = lnast-&gt;add_child(idx_func,   Lnast_node::create_stmts   (token_4));
<span class="hljs-keyword">auto</span> idx_io1     = lnast-&gt;add_child(idx_func,   Lnast_node::create_ref     (token_5)); <span class="hljs-comment">//string_view = "$a"</span>
<span class="hljs-keyword">auto</span> idx_io2     = lnast-&gt;add_child(idx_func,   Lnast_node::create_ref     (token_6)); <span class="hljs-comment">//string_view = "$b"</span>
<span class="hljs-keyword">auto</span> idx_io3     = lnast-&gt;add_child(idx_func,   Lnast_node::create_ref     (token_7)); <span class="hljs-comment">//string_view = "$out"</span>

<span class="hljs-keyword">auto</span> idx_xor     = lnast-&gt;add_child(idx_stmts1, Lnast_node::create_xor     (token_7)); 
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_xor,    Lnast_node::create_ref     (token_8)); <span class="hljs-comment">//string_view = "___b"</span>
<span class="hljs-keyword">auto</span> idx_op1     = lnast-&gt;add_child(idx_xor,    Lnast_node::create_ref     (token_9)); <span class="hljs-comment">//string_view = "$a"</span>
<span class="hljs-keyword">auto</span> idx_op2     = lnast-&gt;add_child(idx_xor,    Lnast_node::create_ref     (token_a)); <span class="hljs-comment">//string_view = "$b"</span>

<span class="hljs-keyword">auto</span> idx_assign  = lnast-&gt;add_child(idx_stmts1, Lnast_node::create_assign  (token_b));
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref     (token_c)); <span class="hljs-comment">//string_view = "%out"</span>
<span class="hljs-keyword">auto</span> idx_op1     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref     (token_d)); <span class="hljs-comment">//string_view = "___b"</span>

<span class="hljs-keyword">auto</span> idx_assign  = lnast-&gt;add_child(idx_stmts0, Lnast_node::create_assign  (token_e));
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref     (token_f)); <span class="hljs-comment">//string_view = "func_xor"</span>
<span class="hljs-keyword">auto</span> idx_op1     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref     (token_g)); <span class="hljs-comment">//string_view = "\___a"</span>
</code></pre>
<p><img src="source/graphviz/function_def_conditional.png" alt="assign"></p>
<h1 id="function-call">Function Call</h1>
<h2 id="implicit-function-argument-assignment">Implicit Function Argument Assignment</h2>
<pre class="highlight"><code>// Pyrope
func_xor = :($a, $b, %out):{
  %out = $a ^ $b
}

my_xor = func_xor($foo, $bar)
%out = my_xor.out
</code></pre>
<pre class="highlight tab tab-verilog"><code><span class="hljs-comment">// Verilog</span>
<span class="hljs-keyword">module</span> func_xor(
  <span class="hljs-keyword">input</span> a,
  <span class="hljs-keyword">input</span> b,
  outpout <span class="hljs-keyword">wire</span> out
);

  <span class="hljs-keyword">assign</span> out = a ^ b;

<span class="hljs-keyword">endmodule</span>

<span class="hljs-keyword">module</span> top(
  <span class="hljs-keyword">input</span> foo,
  <span class="hljs-keyword">input</span> bar,
  <span class="hljs-keyword">output</span> <span class="hljs-keyword">wire</span> out
);

  func_xor my_xor(<span class="hljs-variable">.a</span>(foo), <span class="hljs-variable">.b</span>(bar), <span class="hljs-variable">.out</span>(out))

<span class="hljs-keyword">endmodule</span>


</code></pre>
<pre class="highlight tab tab-shell"><code>// CFG 
1   0  0  SEQ0                                            
2   1  0  0     47    ::{   ___a      null      <span class="hljs-variable">$a</span>    <span class="hljs-variable">$b</span>  %out
4   2  0  SEQ1                                            
5   4  0  0     47    ^     ___b      <span class="hljs-variable">$a</span>        <span class="hljs-variable">$b</span>        
6   4  1  0     47    =     %out      ___b                
7   1  1  0     47    =     func_xor  \___a               
8   1  0  TUP0  ___d                                      
9   8  2  49    =     null  <span class="hljs-variable">$foo</span>                          
10  8  3  49    =     null  <span class="hljs-variable">$bar</span>                          
11  1  4  49    78    .()   my_xor    func_xor  ___d      
13  1  6  79    96    .     ___f      my_xor    out       
15  1  8  79    96    =     %out      ___f                
</code></pre>
<pre class="highlight tab tab-cpp"><code><span class="hljs-comment">//C++ </span>
<span class="hljs-keyword">auto</span> idx_stmts0 = lnast-&gt;add_child(idx_root,   Lnast_node::create_stmts   (token_0));
<span class="hljs-keyword">auto</span> idx_func   = lnast-&gt;add_child(idx_stmts0, Lnast_node::create_func_def(token_1));

<span class="hljs-keyword">auto</span> idx_fname  = lnast-&gt;add_child(idx_func,   Lnast_node::create_ref     (token_2)); <span class="hljs-comment">//string_view = "func_xor"</span>
<span class="hljs-keyword">auto</span> idx_cond   = lnast-&gt;add_child(idx_func,   Lnast_node::create_cond    (token_3)); <span class="hljs-comment">//string_view = "true"</span>
<span class="hljs-keyword">auto</span> idx_stmts1 = lnast-&gt;add_child(idx_func,   Lnast_node::create_stmts   (token_4));
<span class="hljs-keyword">auto</span> idx_io1    = lnast-&gt;add_child(idx_func,   Lnast_node::create_ref     (token_5)); <span class="hljs-comment">//string_view = "$a"</span>
<span class="hljs-keyword">auto</span> idx_io2    = lnast-&gt;add_child(idx_func,   Lnast_node::create_ref     (token_6)); <span class="hljs-comment">//string_view = "$b"</span>
<span class="hljs-keyword">auto</span> idx_io3    = lnast-&gt;add_child(idx_func,   Lnast_node::create_ref     (token_7)); <span class="hljs-comment">//string_view = "$out"</span>

<span class="hljs-keyword">auto</span> idx_xor    = lnast-&gt;add_child(idx_stmts1, Lnast_node::create_xor     (token_8)); 
<span class="hljs-keyword">auto</span> idx_lhs    = lnast-&gt;add_child(idx_xor,    Lnast_node::create_ref     (token_9)); <span class="hljs-comment">//string_view = "___b"</span>
<span class="hljs-keyword">auto</span> idx_op1    = lnast-&gt;add_child(idx_xor,    Lnast_node::create_ref     (token_a)); <span class="hljs-comment">//string_view = "$a"</span>
<span class="hljs-keyword">auto</span> idx_op2    = lnast-&gt;add_child(idx_xor,    Lnast_node::create_ref     (token_b)); <span class="hljs-comment">//string_view = "$b"</span>

<span class="hljs-keyword">auto</span> idx_assign = lnast-&gt;add_child(idx_stmts1, Lnast_node::create_assign  (token_c));
<span class="hljs-keyword">auto</span> idx_lhs    = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref     (token_d)); <span class="hljs-comment">//string_view = "%out"</span>
<span class="hljs-keyword">auto</span> idx_op1    = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref     (token_e)); <span class="hljs-comment">//string_view = "___b"</span>

<span class="hljs-keyword">auto</span> idx_assign  = lnast-&gt;add_child(idx_stmts0, Lnast_node::create_assign  (token_f));
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref     (token_g)); <span class="hljs-comment">//string_view = "func_xor"</span>
<span class="hljs-keyword">auto</span> idx_op1     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref     (token_h)); <span class="hljs-comment">//string_view = "\___a"</span>

<span class="hljs-keyword">auto</span> idx_tup    = lnast-&gt;add_child(idx_stmts0, Lnast_node::create_tuple    (token_i)); 
<span class="hljs-keyword">auto</span> idx_tname  = lnast-&gt;add_child(idx_tup,    Lnast_node::create_ref      (token_j)); <span class="hljs-comment">//string_view = "___d"</span>
<span class="hljs-keyword">auto</span> idx_assign = lnast-&gt;add_child(idx_tup,    Lnast_node::create_assign   (token_k));
<span class="hljs-keyword">auto</span> idx_lhs    = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref      (token_l)); <span class="hljs-comment">//string_view = "null"</span>
<span class="hljs-keyword">auto</span> idx_op3    = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref      (token_m)); <span class="hljs-comment">//string_view = "$foo"</span>

<span class="hljs-keyword">auto</span> idx_assign = lnast-&gt;add_child(idx_tup,    Lnast_node::create_assign   (token_n));
<span class="hljs-keyword">auto</span> idx_lhs    = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref      (token_o)); <span class="hljs-comment">//string_view = "null"</span>
<span class="hljs-keyword">auto</span> idx_op3    = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref      (token_p)); <span class="hljs-comment">//string_view = "$bar"</span>

<span class="hljs-keyword">auto</span> idx_fcall  = lnast-&gt;add_child(idx_stmts0, Lnast_node::create_func_call(token_q));
<span class="hljs-keyword">auto</span> idx_lhs    = lnast-&gt;add_child(idx_fcall,  Lnast_node::create_ref      (token_r)); <span class="hljs-comment">//string_view = "my_xor"</span>
<span class="hljs-keyword">auto</span> idx_target = lnast-&gt;add_child(idx_fcall,  Lnast_node::create_ref      (token_s)); <span class="hljs-comment">//string_view = "func_xor"</span>
<span class="hljs-keyword">auto</span> idx_arg    = lnast-&gt;add_child(idx_fcall,  Lnast_node::create_ref      (<span class="hljs-keyword">token_t</span>)); <span class="hljs-comment">//string_view = "___d"</span>

<span class="hljs-keyword">auto</span> idx_dot    = lnast-&gt;add_child(idx_stmts0, Lnast_node::create_dot      (token_u)); 
<span class="hljs-keyword">auto</span> idx_lhs    = lnast-&gt;add_child(idx_dot   , Lnast_node::create_ref      (token_v)); <span class="hljs-comment">//string_view = "___f"</span>
<span class="hljs-keyword">auto</span> idx_op1    = lnast-&gt;add_child(idx_dot   , Lnast_node::create_ref      (token_w)); <span class="hljs-comment">//string_view = "my_xor"</span>
<span class="hljs-keyword">auto</span> idx_op2    = lnast-&gt;add_child(idx_dot   , Lnast_node::create_ref      (token_x)); <span class="hljs-comment">//string_view = "out"</span>

<span class="hljs-keyword">auto</span> idx_assign = lnast-&gt;add_child(idx_stmts0, Lnast_node::create_assign   (token_y));
<span class="hljs-keyword">auto</span> idx_lhs    = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref      (token_z)); <span class="hljs-comment">//string_view = "%out"</span>
<span class="hljs-keyword">auto</span> idx_op1    = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref      (token_aa));<span class="hljs-comment">//string_view = "___f"</span>

</code></pre>
<p><img src="source/graphviz/function_call_imp.png" alt="assign"></p>
<h2 id="explicit-function-argument-assignment">Explicit Function Argument Assignment</h2>
<pre class="highlight"><code>// Pyrope
func_xor = :($a, $b, %out):{
  %out = $a ^ $b
}

my_xor = func_xor(a = $foo, b = $bar)
%out = my_xor.out
</code></pre>
<pre class="highlight tab tab-verilog"><code><span class="hljs-comment">// Verilog</span>
<span class="hljs-keyword">module</span> func_xor(
  <span class="hljs-keyword">input</span> a,
  <span class="hljs-keyword">input</span> b,
  outpout <span class="hljs-keyword">wire</span> out
);

  <span class="hljs-keyword">assign</span> out = a ^ b;

<span class="hljs-keyword">endmodule</span>

<span class="hljs-keyword">module</span> top(
  <span class="hljs-keyword">input</span> foo,
  <span class="hljs-keyword">input</span> bar,
  <span class="hljs-keyword">output</span> <span class="hljs-keyword">wire</span> out
);

  func_xor my_xor(<span class="hljs-variable">.a</span>(foo), <span class="hljs-variable">.b</span>(bar), <span class="hljs-variable">.out</span>(out))

<span class="hljs-keyword">endmodule</span>
</code></pre>
<pre class="highlight tab tab-shell"><code>// CFG 
1   0  0   SEQ0                                           
2   1  0   0     47    ::{  ___a      null      <span class="hljs-variable">$a</span>    <span class="hljs-variable">$b</span>  %out
4   2  0   SEQ1                                           
5   4  0   0     47    ^    ___b      <span class="hljs-variable">$a</span>        <span class="hljs-variable">$b</span>        
6   4  1   0     47    =    %out      ___b                
7   1  1   0     47    =    func_xor  \___a               
8   1  0   TUP0  ___d                                     
10  8  3   49    86    =    a         <span class="hljs-variable">$foo</span>                
12  8  5   49    86    =    b         <span class="hljs-variable">$bar</span>                
13  1  6   49    86    .()  ___c      func_xor  ___d      
14  1  7   49    86    =    my_xor    ___c                
15  1  8   87    104   .    ___j      my_xor    out       
17  1  10  87    104   =    %out      ___j                
</code></pre>
<pre class="highlight tab tab-cpp"><code><span class="hljs-comment">//C++ </span>
<span class="hljs-keyword">auto</span> idx_stmts0 = lnast-&gt;add_child(idx_root,   Lnast_node::create_stmts   (token_0));
<span class="hljs-keyword">auto</span> idx_func   = lnast-&gt;add_child(idx_stmts0, Lnast_node::create_func_def(token_1));

<span class="hljs-keyword">auto</span> idx_fname  = lnast-&gt;add_child(idx_func,   Lnast_node::create_ref     (token_2)); <span class="hljs-comment">//string_view = "func_xor"</span>
<span class="hljs-keyword">auto</span> idx_cond   = lnast-&gt;add_child(idx_func,   Lnast_node::create_cond    (token_3)); <span class="hljs-comment">//string_view = "true"</span>
<span class="hljs-keyword">auto</span> idx_stmts1 = lnast-&gt;add_child(idx_func,   Lnast_node::create_stmts   (token_4));
<span class="hljs-keyword">auto</span> idx_io1    = lnast-&gt;add_child(idx_func,   Lnast_node::create_ref     (token_5)); <span class="hljs-comment">//string_view = "$a"</span>
<span class="hljs-keyword">auto</span> idx_io2    = lnast-&gt;add_child(idx_func,   Lnast_node::create_ref     (token_6)); <span class="hljs-comment">//string_view = "$b"</span>
<span class="hljs-keyword">auto</span> idx_io3    = lnast-&gt;add_child(idx_func,   Lnast_node::create_ref     (token_7)); <span class="hljs-comment">//string_view = "$out"</span>

<span class="hljs-keyword">auto</span> idx_xor    = lnast-&gt;add_child(idx_stmts1, Lnast_node::create_xor     (token_8)); 
<span class="hljs-keyword">auto</span> idx_lhs    = lnast-&gt;add_child(idx_xor,    Lnast_node::create_ref     (token_9)); <span class="hljs-comment">//string_view = "___b"</span>
<span class="hljs-keyword">auto</span> idx_op1    = lnast-&gt;add_child(idx_xor,    Lnast_node::create_ref     (token_a)); <span class="hljs-comment">//string_view = "$a"</span>
<span class="hljs-keyword">auto</span> idx_op2    = lnast-&gt;add_child(idx_xor,    Lnast_node::create_ref     (token_b)); <span class="hljs-comment">//string_view = "$b"</span>

<span class="hljs-keyword">auto</span> idx_assign = lnast-&gt;add_child(idx_stmts1, Lnast_node::create_assign  (token_c));
<span class="hljs-keyword">auto</span> idx_lhs    = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref     (token_d)); <span class="hljs-comment">//string_view = "%out"</span>
<span class="hljs-keyword">auto</span> idx_op1    = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref     (token_e)); <span class="hljs-comment">//string_view = "___b"</span>

<span class="hljs-keyword">auto</span> idx_assign  = lnast-&gt;add_child(idx_stmts0, Lnast_node::create_assign  (token_f));
<span class="hljs-keyword">auto</span> idx_lhs     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref     (token_g)); <span class="hljs-comment">//string_view = "func_xor"</span>
<span class="hljs-keyword">auto</span> idx_op1     = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref     (token_h)); <span class="hljs-comment">//string_view = "\___a"</span>

<span class="hljs-keyword">auto</span> idx_tup    = lnast-&gt;add_child(idx_stmts0, Lnast_node::create_tuple    (token_i)); 
<span class="hljs-keyword">auto</span> idx_tname  = lnast-&gt;add_child(idx_tup,    Lnast_node::create_ref      (token_j)); <span class="hljs-comment">//string_view = "___d"</span>
<span class="hljs-keyword">auto</span> idx_assign = lnast-&gt;add_child(idx_tup,    Lnast_node::create_assign   (token_k));
<span class="hljs-keyword">auto</span> idx_lhs    = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref      (token_l)); <span class="hljs-comment">//string_view = "a"</span>
<span class="hljs-keyword">auto</span> idx_op3    = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref      (token_m)); <span class="hljs-comment">//string_view = "$foo"</span>

<span class="hljs-keyword">auto</span> idx_assign = lnast-&gt;add_child(idx_tup,    Lnast_node::create_assign   (token_n));
<span class="hljs-keyword">auto</span> idx_lhs    = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref      (token_o)); <span class="hljs-comment">//string_view = "b"</span>
<span class="hljs-keyword">auto</span> idx_op3    = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref      (token_p)); <span class="hljs-comment">//string_view = "$bar"</span>

<span class="hljs-keyword">auto</span> idx_fcall  = lnast-&gt;add_child(idx_stmts0, Lnast_node::create_func_call(token_q));
<span class="hljs-keyword">auto</span> idx_lhs    = lnast-&gt;add_child(idx_fcall,  Lnast_node::create_ref      (token_r)); <span class="hljs-comment">//string_view = "my_xor"</span>
<span class="hljs-keyword">auto</span> idx_target = lnast-&gt;add_child(idx_fcall,  Lnast_node::create_ref      (token_s)); <span class="hljs-comment">//string_view = "func_xor"</span>
<span class="hljs-keyword">auto</span> idx_arg    = lnast-&gt;add_child(idx_fcall,  Lnast_node::create_ref      (<span class="hljs-keyword">token_t</span>)); <span class="hljs-comment">//string_view = "___d"</span>

<span class="hljs-keyword">auto</span> idx_dot    = lnast-&gt;add_child(idx_stmts0, Lnast_node::create_dot      (token_u)); 
<span class="hljs-keyword">auto</span> idx_lhs    = lnast-&gt;add_child(idx_dot   , Lnast_node::create_ref      (token_v)); <span class="hljs-comment">//string_view = "___j"</span>
<span class="hljs-keyword">auto</span> idx_op1    = lnast-&gt;add_child(idx_dot   , Lnast_node::create_ref      (token_w)); <span class="hljs-comment">//string_view = "my_xor"</span>
<span class="hljs-keyword">auto</span> idx_op2    = lnast-&gt;add_child(idx_dot   , Lnast_node::create_ref      (token_x)); <span class="hljs-comment">//string_view = "out"</span>

<span class="hljs-keyword">auto</span> idx_assign = lnast-&gt;add_child(idx_stmts0, Lnast_node::create_assign   (token_y));
<span class="hljs-keyword">auto</span> idx_lhs    = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref      (token_z)); <span class="hljs-comment">//string_view = "%out"</span>
<span class="hljs-keyword">auto</span> idx_op1    = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref      (token_aa));<span class="hljs-comment">//string_view = "___j"</span>
</code></pre>
<p><img src="source/graphviz/function_call_exp.png" alt="assign"></p>
<pre class="highlight"><code>// Pyrope
val = 1023u10bits
</code></pre>
<h1 id="attribute-statement">Attribute statement</h1>
<p>There are two ways to set an attribute to a variable or tuple,
using &quot;.&quot; dot operator directly or using as (__attr = foo).
An classical attribute setting is bitwidth assignment.</p>
<pre class="highlight"><code>// Pyrope
foo.__bits = 3
foo = 7

bar as (__bits = 10)
bar = 123

</code></pre>
<pre class="highlight tab tab-verilog"><code><span class="hljs-comment">// Verilog</span>
<span class="hljs-keyword">wire</span> [<span class="hljs-number">2</span>:<span class="hljs-number">0</span>] foo;
<span class="hljs-keyword">wire</span> [<span class="hljs-number">9</span>:<span class="hljs-number">0</span>] bar;

<span class="hljs-keyword">assign</span> foo = <span class="hljs-number">7</span>;
<span class="hljs-keyword">assign</span> bar = <span class="hljs-number">123</span>;

</code></pre>
<pre class="highlight tab tab-shell"><code>// CFG
1       0       0       SEQ0
2       1       0       0       14      .       ___a    foo     __bits
3       1       1       0       14      =       ___a    0d3
4       1       2       15      22      =       foo     0d7
5       1       0       TUP0    ___b
6       5       3       24      44      =       __bits  0d10
7       1       4       24      44      as      bar     ___b
8       1       5       45      54      =       bar     0d123
</code></pre>
<pre class="highlight tab tab-cpp"><code><span class="hljs-comment">// C++</span>

<span class="hljs-keyword">auto</span> idx_dot    = lnast-&gt;add_child(idx_stmts, Lnast_node::create_dot    (token1));
<span class="hljs-keyword">auto</span> idx_lhs1   = lnast-&gt;add_child(idx_dot,   Lnast_node::create_ref    (token2)); <span class="hljs-comment">// string_view = ___a</span>
<span class="hljs-keyword">auto</span> idx_op1    = lnast-&gt;add_child(idx_dot,   Lnast_node::create_ref    (token3)); <span class="hljs-comment">// string_view = foo       </span>
<span class="hljs-keyword">auto</span> idx_op2    = lnast-&gt;add_child(idx_dot,   Lnast_node::create_ref    (token4)); <span class="hljs-comment">// string_view = __bits       </span>

<span class="hljs-keyword">auto</span> idx_assign = lnast-&gt;add_child(idx_stmts,  Lnast_node::create_assign(token5));
<span class="hljs-keyword">auto</span> idx_lhs2   = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref   (token6)); <span class="hljs-comment">// string_view = ___a</span>
<span class="hljs-keyword">auto</span> idx_op3    = lnast-&gt;add_child(idx_assign, Lnast_node::create_const (token7)); <span class="hljs-comment">// string_view = 0d3       </span>


<span class="hljs-keyword">auto</span> idx_assign = lnast-&gt;add_child(idx_stmts,  Lnast_node::create_assign(token8));
<span class="hljs-keyword">auto</span> idx_lhs2   = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref   (token9)); <span class="hljs-comment">// string_view = foo</span>
<span class="hljs-keyword">auto</span> idx_op3    = lnast-&gt;add_child(idx_assign, Lnast_node::create_const (tokena)); <span class="hljs-comment">// string_view = 0d7       </span>

<span class="hljs-keyword">auto</span> idx_tup    = lnast-&gt;add_child(idx_stmts,  Lnast_node::create_tuple (tokenb));
<span class="hljs-keyword">auto</span> idx_tname  = lnast-&gt;add_child(idx_tup,    Lnast_node::create_ref   (tokenc)); <span class="hljs-comment">// string_view = ___b</span>

<span class="hljs-keyword">auto</span> idx_assign = lnast-&gt;add_child(idx_tup,    Lnast_node::create_assign(tokend));
<span class="hljs-keyword">auto</span> idx_lhs    = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref   (tokene)); <span class="hljs-comment">//string_view = "__bits"</span>
<span class="hljs-keyword">auto</span> idx_op4    = lnast-&gt;add_child(idx_assign, Lnast_node::create_const (tokenf)); <span class="hljs-comment">//string_view = "0d10"</span>


<span class="hljs-keyword">auto</span> idx_as     = lnast-&gt;add_child(idx_stmts,  Lnast_node::create_as    (tokeng));
<span class="hljs-keyword">auto</span> idx_lhs    = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref   (tokenh)); <span class="hljs-comment">//string_view = "bar"</span>
<span class="hljs-keyword">auto</span> idx_op5    = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref   (tokeni)); <span class="hljs-comment">//string_view = "___b"</span>

<span class="hljs-keyword">auto</span> idx_assign = lnast-&gt;add_child(idx_stmts,  Lnast_node::create_assign(tokenj));
<span class="hljs-keyword">auto</span> idx_lhs    = lnast-&gt;add_child(idx_assign, Lnast_node::create_ref   (tokenk)); <span class="hljs-comment">//string_view = "bar"</span>
<span class="hljs-keyword">auto</span> idx_op6    = lnast-&gt;add_child(idx_assign, Lnast_node::create_const (tokenk)); <span class="hljs-comment">//string_view = "0d123"</span>

</code></pre>
<p><img src="source/graphviz/attribute.png" alt="assign"></p>
<h1 id="string-management">String management</h1>
<p>LNAST has to handle lots of strings. Each LNAST node has several strings, for
example, the simple &quot;ref&quot; node has 2 strings: the variable name and the
contents.</p>
<p>The LNAST interface does not allocate strings when passed as arguments. The reason
is that it accepts std::string_view as argument. The LNAST internals assume that someone
else handles the string allocations. A code like this will result in incorrect behaviour:</p>
<pre class="highlight"><code>// WARNING: INCORRECT CODE
std::string str{&quot;foo&quot;};
str += &quot;bar&quot;;
auto Lnast_node::create_ref(str);
</code></pre>
<p>The reason is that str is allocated at the stack, and after the function
returns LNAST will have a pointer to incorrect memory region.</p>
<p>The solution is that for newly created strings, the &quot;add_string&quot; API must be called.</p>
<pre class="highlight"><code>// CORRECT CODE to handle strings in LNAST
std::string str{&quot;foo&quot;};
str += &quot;bar&quot;;
auto Lnast_node::create_ref(lnast-&gt;add_string(str));
</code></pre>
<p>The add_string allocates a string inside lnast. When the lnast is de-allocated
the string is garbage collected.</p>
<p>LNAST is optimized to operate with scanner parsers. When LNAST is built, it is possible to
pass a memory region mmaped with all the strings used by the scanner. In this case, the
LNAST can get ownership of a large memory region with all the strings used by the scanner.</p>
<pre class="highlight"><code>// LNAST mmap support
std::pair&lt;std::string_view, int&gt; own;
// own.first points to the mmap region that lnast will munmap at the end
// own.second points to the file descriptor associated to the mmap that must be closed
lnast = std::make_unique&lt;Lnast&gt;(&quot;top_name&quot;, own);
</code></pre>
<!-- Renderer: Shins v2.4.1-0 --><h1 id="examples">Examples</h1>
<h2 id="trivial-counter">trivial counter</h2>
<p>TBD</p>
<!-- Renderer: Shins v2.4.1-0 -->
      </div>
      <div class="dark-box">
        
          <div class="lang-selector">
            
              
                <a href="#" data-language-name="coffescript">pyrope</a>
              
            
              
                <a href="#" data-language-name="verilog">verilog</a>
              
            
              
                <a href="#" data-language-name="shell">cfg</a>
              
            
              
                <a href="#" data-language-name="cpp">cpp</a>
              
            
          </div>
        
      </div>
    </div>
  </body>
</html>
